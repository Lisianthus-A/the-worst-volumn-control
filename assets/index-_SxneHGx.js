import{r as d,j as p,c as Y}from"./index-CRcPnDTE.js";import{d as q}from"./index-CUvrryz7.js";const B="_wrapper_zzp8h_1",F="_canvas_zzp8h_5",m={wrapper:B,canvas:F,"upper-canvas":"_upper-canvas_zzp8h_13"},o=window.devicePixelRatio||1,f=400*o,h=240*o,w=h/2,z=8*o,C=360*o,j=16*o,l=120*o,b=16*o,X=(f-C)/2,H=l+j/2,k=e=>{e.save();let c=0;e.fillStyle="#ffffff";const a=60*.4,u=40*o,n=()=>{if(c>=a){e.restore();return}e.clearRect(0,0,f,h),requestAnimationFrame(n),++c,e.globalAlpha=c/a;const g=c/a*(h-2*u),v=w-(w-u)*(c/a);e.fillRect(0,v,f,g)};n()},_=(e,c)=>{e.save(),e.globalAlpha=.5,e.fillStyle="#1890ff",e.fillRect(c,0,j,h),e.restore()},S=e=>{e.save(),e.fillStyle="#888888",e.fillRect((f-C)/2,w-z/2,C,z),e.restore()},T=(e,c)=>{e.save(),e.fillStyle="#ffffff",e.beginPath(),e.arc(c,w,b,0,2*Math.PI),e.closePath(),e.fill(),e.restore()};function G(){const e=d.useRef(null),c=d.useRef(null),M=d.useRef(null),a=d.useRef(null),u=q(),n=d.useRef({isDragging:!1,offset:[0,0],circleX:(X+H)/2,t:[0,0],beginX:0}),g=()=>{n.current.isDragging=!1,window.removeEventListener(u?"touchend":"mouseup",g)},v=t=>{if(!n.current.isDragging)return;const r=t.touches[0],[s]=n.current.offset;let i=(r.pageX-s)*o;i=Math.max(i,X),i=Math.min(i,l),y(i)},D=t=>{if(!n.current.isDragging)return;const[r]=n.current.offset;let s=(t.pageX-r)*o;s=Math.max(s,X),s=Math.min(s,l),y(s)},A=t=>{if(t.button!==0)return;const[r,s]=n.current.offset,i=(t.pageX-r)*o,R=(t.pageY-s)*o,E=Math.sqrt(Math.pow(i-n.current.circleX,2)+Math.pow(R-w,2))<=b;n.current.isDragging=E,D(t),window.addEventListener("mouseup",g)},W=t=>{const r=t.touches[0],[s,i]=n.current.offset,R=(r.pageX-s)*o,L=(r.pageY-i)*o,P=Math.sqrt(Math.pow(R-n.current.circleX,2)+Math.pow(L-w,2))<=b;n.current.isDragging=P,v(t),window.addEventListener("touchend",g)},N=()=>{const t=M.current;t&&k(t)},y=t=>{const r=a.current;if(!r)return;r.clearRect(0,0,f,h);const s=Date.now();if((s-n.current.t[0]>100||t<=n.current.circleX)&&(n.current.t[1]=s,n.current.beginX=t),n.current.t[0]=s,n.current.circleX=t,S(r),_(r,l),T(r,t),t>=l){const i=Date.now()-n.current.t[1];(l-n.current.beginX)/i*1e3/o,l-n.current.beginX,g()}};return d.useEffect(()=>{const t=e.current,r=c.current;!t||!r||(M.current=t.getContext("2d"),a.current=r.getContext("2d"),a.current&&(a.current.clearRect(0,0,f,h),S(a.current),_(a.current,l),T(a.current,n.current.circleX)))},[]),d.useEffect(()=>{const t=c.current;if(!t)return;const r=()=>{const s=t.getBoundingClientRect();n.current.offset=[s.x,s.y]};return r(),window.addEventListener("resize",r),()=>{window.removeEventListener("resize",r)}},[]),p.jsxs(p.Fragment,{children:[p.jsxs("div",{className:m.wrapper,children:[p.jsx("canvas",{ref:e,className:m.canvas,width:f,height:h}),p.jsx("canvas",{ref:c,className:Y(m.canvas,m["upper-canvas"]),width:f,height:h,onMouseDown:u?void 0:A,onMouseMove:u?void 0:D,onTouchStart:u?W:void 0,onTouchMove:u?v:void 0})]}),p.jsx("button",{onClick:N,children:"whiteAnimate"})]})}export{G as default};
