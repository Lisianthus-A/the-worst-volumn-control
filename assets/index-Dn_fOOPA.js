import{r as c,a as R,j as E}from"./index-DmLUs9u4.js";import{d as L}from"./index-CUvrryz7.js";const S="_canvas_85hl6_1",T={canvas:S},s=window.devicePixelRatio||1,i=4*s,d=200*s,v=32*s,b=d*v;function Y(){const a=c.useRef(null),w=c.useRef(null),r=L(),n=c.useRef({isDrawing:!1,value:0,offset:[0,0]}),h=(e,t)=>{const o=w.current;if(!o||!n.current.isDrawing)return;const u=o.getImageData(e,t,i,i).data;let p=0;for(let l=0;l<u.length;l+=4)u[l]===255&&(p+=1);n.current.value+=p,o.fillRect(e,t,i,i);const x=n.current.value/b*100>>0;R.setVolume(x)},f=()=>{n.current.isDrawing=!1,window.removeEventListener(r?"touchend":"mouseup",f)},g=e=>{const[t,o]=n.current.offset;h((e.pageX-t)*s,(e.pageY-o)*s)},m=e=>{const t=e.touches[0],[o,u]=n.current.offset;h((t.pageX-o)*s,(t.pageY-u)*s)},M=e=>{e.button===0&&(n.current.isDrawing=!0,g(e),window.addEventListener("mouseup",f))},D=e=>{n.current.isDrawing=!0,m(e),window.addEventListener("touchend",f)};return c.useEffect(()=>{if(!a.current)return;const e=a.current.getContext("2d",{willReadFrequently:!0});w.current=e,e.fillStyle="#ffffff",e.fillRect(0,0,d,v),e.fillStyle="#1890ff",R.setVolume(0)},[]),c.useEffect(()=>{const e=a.current;if(!e)return;const t=()=>{n.current.offset=[e.offsetLeft,e.offsetTop]};return t(),window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t)}},[]),E.jsx("canvas",{ref:a,className:T.canvas,width:d,height:v,onMouseDown:r?void 0:M,onMouseMove:r?void 0:g,onTouchStart:r?D:void 0,onTouchMove:r?m:void 0})}export{Y as default};
